# Бот для оптимизации Windows

Этот бот создает скрипты для оптимизации работы Windows на основе скриншота системной информации.

## Требования

- Python 3.6 или выше
- Установленные библиотеки из `requirements.txt`
- Ключи API для Telegram и Claude (Anthropic)

## Установка для разработчиков

1. Клонируйте репозиторий:
```bash
git clone https://github.com/ваш-username/optimization-bot.git
cd optimization-bot
```

2. Установите необходимые зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `example.env` с вашими ключами API:
```bash
cp example.env .env
# Отредактируйте файл .env, добавив ваши ключи API
```

4. Подготовьте структуру директорий:
```bash
mkdir -p data/prompts
```

## Запуск бота

### PowerShell
В PowerShell используйте следующий синтаксис:
```powershell
cd bot_optimixation; python optimization_bot.py
```
или
```powershell
cd bot_optimixation
python optimization_bot.py
```

### Командная строка (CMD)
```cmd
cd bot_optimixation && python optimization_bot.py
```

## Функции бота

- Создание скриптов оптимизации Windows на основе скриншота системы
- Исправление ошибок в существующих скриптах
- Показ статистики по сгенерированным скриптам
- Обновление шаблонов промптов на основе накопленных данных

## Команды бота

- `/start` - Начало работы с ботом
- `/help` - Помощь по использованию
- `/generate` - Сгенерировать новый скрипт оптимизации (нужно приложить фото)
- `/optimize` - Оптимизировать промпты (для администраторов)

## Разработка и вклад в проект

### Ветвление и рабочий процесс Git

1. Создайте свою ветку для работы над задачей:
```bash
git checkout -b feature/название-вашей-фичи
```

2. Внесите изменения и закоммитьте их:
```bash
git add .
git commit -m "Краткое описание изменений"
```

3. Отправьте изменения в удаленный репозиторий:
```bash
git push origin feature/название-вашей-фичи
```

4. Создайте Pull Request через интерфейс GitHub/GitLab

### Правила оформления коммитов

Для коммитов используйте следующий формат:
- `feat:` - новая функциональность
- `fix:` - исправление ошибок
- `docs:` - изменения в документации
- `refactor:` - рефакторинг кода без изменения функциональности
- `test:` - добавление или изменение тестов

Пример: `feat: добавлена функция оптимизации реестра`

## Устранение проблем

### Ошибка "Your credit balance is too low to access the Anthropic API"
Эта ошибка означает, что закончился баланс API-кредитов Anthropic. Бот автоматически переключится на использование шаблонных скриптов. Для полной функциональности необходимо пополнить баланс в аккаунте Anthropic.

### Ошибка запуска в PowerShell ("Лексема "&&" не является допустимым разделителем")
В PowerShell не работает оператор `&&` для объединения команд как в CMD. Используйте точку с запятой (`;`) или запускайте команды по отдельности:
```powershell
cd bot_optimixation
python optimization_bot.py
```

Если при запуске скриптов возникают проблемы:

1. **Ошибки выполнения PowerShell**:
   - Убедитесь, что запускаете скрипт с правами администратора
   - Проверьте политику выполнения PowerShell: `Get-ExecutionPolicy`
   - При необходимости, измените политику: `Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process`

2. **Скрипт не запускается**:
   - Запустите командную строку от имени администратора
   - Перейдите в папку со скриптами: `cd путь_к_папке`
   - Запустите bat-файл вручную: `Start-Optimizer.bat`

3. **Система работает нестабильно после оптимизации**:
   - Все изменения фиксируются в логах, расположенных в `%USERPROFILE%\WindowsOptimizer_Logs`
   - Для откатов оптимизаций можно использовать точки восстановления системы
   - Резервные копии создаются в папке `%USERPROFILE%\WindowsOptimizer_Backups`

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности в файле LICENSE.

## Развертывание на Railway

Этот проект настроен для автоматического развертывания на платформе [Railway](https://railway.app/).

### Настройка Railway

1. Создайте аккаунт на Railway и новый проект
2. Выберите "Deploy from GitHub repo"
3. Подключите свой репозиторий GitHub
4. Добавьте необходимые переменные окружения в Railway:
   - `TELEGRAM_TOKEN`
   - `ANTHROPIC_API_KEY`
   - `CLAUDE_MODEL`
   - `LOG_LEVEL`
   - `ALLOWED_USERS`
   - `ADMIN_USER_ID`

### Ручное развертывание через CLI

1. Установите Railway CLI:
```bash
npm i -g @railway/cli
```

2. Войдите в свой аккаунт:
```bash
railway login
```

3. Привяжите проект:
```bash
railway link
```

4. Разверните проект:
```bash
railway up
```

### Автоматическое развертывание

Railway автоматически разворачивает новую версию при каждом пуше в основную ветку репозитория.
я заебался