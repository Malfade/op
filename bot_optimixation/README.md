# Бот оптимизации Windows

Telegram-бот для создания скриптов оптимизации Windows на основе скриншотов системной информации.

## Требования

- Python 3.6 или выше
- Установленные библиотеки из `requirements.txt`
- Ключи API для Telegram и Claude (Anthropic)

## Установка

1. Клонируйте репозиторий
2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
3. Создайте файл `.env` в корневой директории проекта и добавьте в него следующие переменные:
   ```
   TELEGRAM_TOKEN=ваш_токен_telegram_бота
   ANTHROPIC_API_KEY=ваш_ключ_api_claude
   ```

## Запуск бота

### В Windows (командная строка)

Запустите файл `start_bot.bat`

### В Windows (PowerShell)

Запустите файл `start_bot.ps1`

### Вручную

```
python optimization_bot.py
```

## Функции бота

- Создание скриптов оптимизации Windows на основе скриншота системы
- Исправление ошибок в существующих скриптах
- Показ статистики по сгенерированным скриптам
- Обновление шаблонов промптов на основе накопленных данных

## Команды

- `/start` - начать взаимодействие с ботом
- `/help` - получить справку
- `/stats` - показать статистику
- `/update_prompts` - обновить шаблоны промптов
- `/cancel` - отменить текущую операцию

## Устранение проблем

Если при запуске скриптов возникают проблемы:

1. **Ошибки выполнения PowerShell**:
   - Убедитесь, что запускаете скрипт с правами администратора
   - Проверьте политику выполнения PowerShell: `Get-ExecutionPolicy`
   - При необходимости, измените политику: `Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process`

2. **Скрипт не запускается**:
   - Запустите командную строку от имени администратора
   - Перейдите в папку со скриптами: `cd путь_к_папке`
   - Запустите bat-файл вручную: `Start-Optimizer.bat`

3. **Система работает нестабильно после оптимизации**:
   - Все изменения фиксируются в логах, расположенных в `%USERPROFILE%\WindowsOptimizer_Logs`
   - Для откатов оптимизаций можно использовать точки восстановления системы
   - Резервные копии создаются в папке `%USERPROFILE%\WindowsOptimizer_Backups` 